\chapter{Oplossingsanalyse}

\section{Requirements en capability}
\includesvg[width=\textwidth]{./graphics/1- Analyse.svg}

Doel is om op basis van een voorafgaande literatuurstudie een proof of concept uit te werken die de capability ‘Dreigingsanalyse en dreigingswaarschuwing a.d.h.v. networkflow data’ kan realiseren, rekening houdend met de vereisten van de regulator en SmartEye.

\paragraph{}
Verder is niet de volledigheid van de uitgewerkte oplossing essentieel, maar wel de correctheid en de werkbaarheid van de oplossing.

\subsection{Regulator}
Als telecomoperator dient SmartEye te voldoen aan een reeks verplichtingen, opgelegd door het BIPT (Belgisch Instituut voor postdiensten en telecommunicatie). Zo is op een niet-exhaustieve lijst onder ‘Verplichtingen rond (persoons)gegevens en privacy / Identificatie van eindgebruikers’ volgende verplichting terug te vinden: “Een operator is verplicht de abonnees op zijn elektronische communicatiediensten te identificeren (directe identificatiemethode), of er ten minste voor te zorgen dat de autoriteiten hen kunnen identificeren (indirecte identificatiemethode).

\subsection{SmartEye}
SmartEye wil logischerwijze ook proactief kunnen inspelen op potentiële vragen van de bevoegde overheidsinstanties door mogelijke threats ten allen tijde reeds zelf te onderkennen, en dit tegen een minimale kost.

\section{Oplossingsvoorstel}
\includesvg[width=\textwidth]{./graphics/2_Oplossing_b.svg}

\subsection{Processtappen}
Voorafgaand aan de keuze en de configuratie van de applicatiesoftware is het nodig om een zicht te hebben op de verschillende processtappen die bij deze opzet nodig zijn.

\paragraph{}
De processtappen zijn, in chronologische volgorde, het collecteren en formateren van beschikbare data, het analyseren van deze data en het stockeren ervan. Deze verschillende processtappen worden logischerwijze doorlopen telkens wanneer op firewall-niveau nieuwe flow data ter beschikking komt.

\subsection{Analyse van de firewall-omgeving}
Gezien SmartEye per locatie ervoor zorgt dat een binnenkomend publiek IP gedeeld wordt door meerdere tenants (huuders en/of eindgebruikers) en gezien de vereiste van de regulator om bij een potentiële threat actor zicht te hebben op de exacte locatie van deze tenant, blijkt uit de literatuurstudie dat Carrier-Grade NAT moet geïmplementeerd zijn. Dit betekent dat de firewall-omgeving Carrier-Grade NAT capable moet zijn.

\paragraph{}
Gezien na het beschikbaar komen van nieuwe flow data deze moet kunnen gecollecteerd worden voor verdere afhandeling, moet de firewall-omgeving flow export capable gemaakt worden.

\paragraph{}
Deze beide functionaliteiten dienen aan de standaard firewall service toegevoegd te worden.

\section{Haalbaarheidsanalyse en sturing van de oplossing}
Vanuit de businessvereiste om tot een oplossing te komen met een minimale kost, wordt geopteerd om een oplossing op basis van deterministische NAT-translaties uit te werken. Aan het loggen van alle translaties (als alternatief) hangt immers een stevig storage-prijskaartje. Het BIPT vereist immers om over de historiek van een jaar te beschikken.
